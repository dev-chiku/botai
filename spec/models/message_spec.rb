require 'rails_helper'

RSpec.describe Message, :type => :model do
  #pending "add some examples to (or delete) #{__FILE__}"
  
  # Rails.logger.debug('step1')

  before :all do
    created_messages = create_list(:message, 20)
  end  
  
  it "isn't blank uid" do
    message = Message.new
    message.uid = nil
    message.valid?
    Rails.logger.debug(message.errors)
    expect(message.errors[:uid]).to include(I18n.t('errors.messages.blank'))
  end
  
  it "isn't unique uid" do
    message = Message.new
    message.uid = '00000000000000000001'
    message.valid?
    Rails.logger.debug(message.errors)
    expect(message.errors[:uid]).to include(I18n.t('errors.messages.taken'))
  end

  it "is wrong_length 20 uid" do
    message = Message.new
    message.uid = '123456789012345678901'
    message.valid?
    expect(message.errors[:uid]).to include(I18n.t('errors.messages.wrong_length', :count => 20))
  end
  
  it "isn't alphanumeric half size uid" do
    message = Message.new
    message.uid = '1234567890123456789０'
    message.valid?
    expect(message.errors[:uid]).to include(I18n.t('errors.messages.only_half_alphanumeric'))
  end
  
  it "is blank input_text" do
    message = Message.new
    message.input_text = nil
    message.valid?
    expect(message.errors[:input_text]).to include(I18n.t('errors.messages.blank'))
  end

  it "is too_long 200 input_text" do
    message = Message.new
    message.input_text = '123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901'
    message.valid?
    expect(message.errors[:input_text]).to include(I18n.t('errors.messages.too_long', :count => 200))
  end

  it "is blank res_text" do
    message = Message.new
    message.res_text = nil
    message.valid?
    expect(message.errors[:res_text]).to include(I18n.t('errors.messages.blank'))    
  end

  it "is too_long 1000 res_text" do
    message = Message.new
    message.res_text = '12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789011234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789011234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789011234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890112345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901'
    message.valid?
    expect(message.errors[:res_text]).to include(I18n.t('errors.messages.too_long', :count => 1000))
  end

end